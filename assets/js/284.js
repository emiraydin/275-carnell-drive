"use strict";(self.webpackChunkmp_webgl=self.webpackChunkmp_webgl||[]).push([[284],{38319:(t,e,i)=>{i.d(e,{hf:()=>r,lb:()=>n,tD:()=>o});var s=i(50575);const o=(t,e=200)=>{let i=0,o=0;const n=1/t,r=t=>t.width/t.height;return{resizeDimensions:[{property:s.P.width,setDimension:e=>(i=r(e)<t?e.width:e.height*t,i),duration:e},{property:s.P.height,setDimension:e=>(o=r(e)<t?e.width*n:e.height,o),duration:e},{property:s.P.top,setDimension:e=>r(e)<t?(e.height-o)/2:0,duration:e},{property:s.P.left,setDimension:e=>r(e)<t?0:(e.width-i)/2,duration:e}]}},n=(t=200)=>({resizeDimensions:[{property:s.P.width,setDimension:t=>t.width,duration:t},{property:s.P.height,setDimension:t=>t.height,duration:t},{property:s.P.top,setDimension:()=>0,duration:t},{property:s.P.left,setDimension:()=>0,duration:t}]}),r=(t,e,i,o=200)=>{const n=[];return void 0!==t&&n.push({property:s.P.width,setDimension:e=>e.width+t,duration:o}),void 0!==e&&n.push({property:s.P.height,setDimension:t=>t.height+e,duration:o}),void 0!==i&&n.push({property:s.P.left,setDimension:()=>i,duration:o}),{resizeDimensions:n}}},7402:(t,e,i)=>{i.d(e,{g:()=>c});var s=i(81396),o=i(17878),n=i(56512),r=i(82814),a=i(12529),h=i(53203);class c extends r.S{constructor(t,e,i=o.o.ALL){super(),this._opacity=1,this._chunks=[],this.size=new s.Vector3,this.center=new s.Vector3,this.built=!1,this.layers.mask=i.mask,this.name=`RoomMesh:${t}-${e}`,this.meshGroup=t,this.meshSubgroup=e,this.renderOrder=a.z.default,this.onBeforeRender=(t,e,i,s,o,n)=>{this.updateUniforms(o,n)}}dispose(){this.reset()}reset(){this._chunks.length=0,this.geometry.dispose(),delete this.onBuild,delete this.onOpacityUpdate,this.built=!1}addChunk(t){-1===this._chunks.indexOf(t)&&this._chunks.push(t)}getChunk(t){return this._chunks[t]}build(){if(this.built)throw new Error("build() should only be called once");if(!this._chunks.length)return;const t=(0,n.qf)(this._chunks.map((t=>t.geometry)));t.clearGroups();let e=0;this.material=[],this._chunks.forEach(((i,s)=>{i.geometry&&i.geometry.index&&(t.addGroup(e,i.geometry.index.count,s),e+=i.geometry.index.count,i.geometry.dispose(),i.geometry=t,i.notifyOnMaterialUpdated((t=>{Array.isArray(this.material)&&(this.material[s]=t),this.onMaterialUpdate&&this.onMaterialUpdate()})),i.onOpacityUpdate=t=>{this.opacity=t})})),this.geometry=t,this.geometry.computeBoundingBox(),this.geometry.computeBoundingSphere(),this.material=this._chunks.map((t=>t.material)),this.size=this.boundingBox.getSize(this.size),this.center=this.boundingBox.getCenter(this.center),this.built=!0,this.onBuild&&this.onBuild()}buildWithTileChunk(t){if(this.built)return;const{meshGroup:e,meshSubgroup:i,lod:s}=t;this.name=`RoomMesh:${s}-${e}-${i}-${t.chunkIndex}`,this.meshGroup=e,this.meshSubgroup=i,this._chunks.push(t),t.notifyOnMaterialUpdated((t=>{this.material=t,this.onMaterialUpdate&&this.onMaterialUpdate()})),t.onOpacityUpdate=t=>{this.opacity=t},this.size=this.boundingBox.getSize(this.size),this.center=this.boundingBox.getCenter(this.center),this.built=!0,this.onBuild&&this.onBuild()}updateUniforms(t,e){t instanceof s.RawShaderMaterial&&(e?this.chunks[e.materialIndex].onBeforeDraw(t):this.chunks.length&&this.chunks[0].onBeforeDraw(t))}get boundingBox(){return(0,n.A5)(this.geometry)}set opacity(t){t!==this.opacity&&(this._opacity=t,this.raycastEnabled=t>h.xx.FADE_CLICKABLE_THRESHOLD,this.renderOrder=t<h.xx.FADE_OPAQUE?a.z.ghostFloor:a.z.default,this.onOpacityUpdate&&this.onOpacityUpdate(t))}get opacity(){return this._opacity}get chunks(){return this._chunks}getSortKey(){return this.chunks.length?this._chunks[0].getSortKey():0}}},14564:(t,e,i)=>{i.d(e,{u:()=>r});var s,o,n=i(19663);!function(t){t.all="all",t.byMeshGroup="byMeshGroup",t.byMeshSubGroup="byMeshSubGroup"}(s||(s={})),function(t){t.explicit="explicit",t.random="random"}(o||(o={}));class r extends n.m{constructor(t,e){super(),this.id="SET_MESH_OVERLAY_COLOR",this.payload={selectBy:(null==e?void 0:e.style)||s.all,colorStyle:(null==t?void 0:t.style)||o.explicit,color:(null==t?void 0:t.color)||null,alpha:(null==t?void 0:t.alpha)||.5,index:null==e?void 0:e.index}}}r.selectBy=s,r.colorBy=o,r.COLOR_DIM={x:0,y:0,z:0,w:.3}},75810:(t,e,i)=>{i.d(e,{I:()=>o});var s=i(19663);class o extends s.m{constructor(t){super(),this.id="TOGGLE_MESH_OVERLAY_COLOR",this.payload={enabled:t}}}},21270:(t,e,i)=>{var s;i.d(e,{V:()=>s}),function(t){t[t.Min=0]="Min",t[t.Standard=1]="Standard",t[t.High=2]="High",t[t.Detail=3]="Detail"}(s||(s={}))},51524:(t,e,i)=>{i.d(e,{t:()=>a});var s=i(59279),o=i(53261),n=i(31362),r=i(21270);const a={urlTemplateToken:"<file>",initialMaxLOD:r.V.Min,nonMeshMaxLOD:r.V.Standard,maxLOD:r.V.High,minLOD:r.V.Min,loadSiblings:!0,displayActiveTiles:!1,autoDisableRendererCulling:!0,optimizeRaycast:!1,stopAtEmptyTiles:!1,disableTileUpdates:!1,disposeModel:!1,limitMemoryUsage:(0,n.tq)(),allocatedMegsBeforeLimitingLod:350,lruMinExtraTiles:(0,n.tq)()?0:100,lruMaxTiles:800,lruUnloadPercent:.05,tileAssetRequestPriority:o.ru.MEDIUM,downloadQueueConcurrency:8,parseQueueConcurrency:10,snappingMaxLOD:r.V.Standard,errorTarget:Number((0,s.eY)("errorTarget",(0,n.tq)()?6:4)),errorMultiplierHiddenFloors:.01,errorMultiplierRaycastOcclusion:.1,smallMeshThreshold:Number((0,s.eY)("smallMeshThreshold",40)),smallMeshErrorMultiplier:Number((0,s.eY)("smallMeshErrorMultiplier",.1))}},26269:(t,e,i)=>{i.d(e,{$4:()=>n,oR:()=>o});var s=i(7402);const o=t=>!!t&&t instanceof s.g,n={hasMeshGroup:t=>"object"==typeof t&&!!t&&"meshGroup"in t,hasMeshSubgroup:t=>"object"==typeof t&&!!t&&"meshSubgroup"in t,isRoomMesh:o,isVisibleRoomMesh:t=>o(t)&&t.raycastEnabled&&t.visible}},88338:(t,e,i)=>{i.d(e,{E:()=>s});const s={longerTransitionMaxDist:10,TRANSITION_TIME_DH:650}},20043:(t,e,i)=>{i.d(e,{Gs:()=>h,Tq:()=>c,bG:()=>l});var s=i(98169),o=i(81248),n=i(88338);if(984==i.j)var r=i(35895);if(984==i.j)var a=i(12039);function h(t){return(0,r.k1)((()=>t(new a.ZK)),(()=>t(new a.Lp)),!1)}const c=(t,e,i,s,...o)=>u({sweepData:t,direction:e,directionFactor:i,sourceSweep:s,ignoreSweeps:o}),u=t=>{const{sweepData:e,direction:i,sourceSweep:n,ignoreSweeps:r,directionFactor:a}=t;if(!e.currentSweepObject)return[];const h=n||e.currentSweepObject,c=[s.ff(h),s._k(),s.vO(h),s.pI(h.position,i,a)];for(const t of r)c.push(s.ff(t));const u=[o.o7(h.position,i),o.TE(h.position)],l=e.getSweepNeighbours(h);return e.sortByScore(c,u,l)},l=(t,e,i,r)=>{const a=[s._k(),s._T()],h=[o.Dv(i.point)],c=t.currentSweepObject;e&&c&&a.push(s.ff(c),s.SF(c.position,n.E.longerTransitionMaxDist),s.vO(c)),i.face&&a.push(s.D5(i.point,i.face.normal));const u=r.floorIdFromObject(i.object);u&&h.push(o.Bv(u));const l=t.sortByScore(a,h);if(0===l.length){const e=t.getClosestSweep(i.point,!0);l.push({sweep:e,score:0})}return l}},3907:(t,e,i)=>{i.d(e,{MU:()=>a});var s,o=i(39880),n=i(44584);!function(t){t.GET="GET",t.POST="POST",t.PATCH="PATCH",t.PUT="PUT",t.DELETE="DELETE",t.OPTIONS="OPTIONS"}(s||(s={}));class r extends class{constructor(){this._options={responseType:"json"}}get options(){const t=this._options;return t.headers=(0,n.m)(this.url,this._options.headers||{}),t}}{constructor(t){super(),this.config=t,this.url=t.path}async read(){const{deserialize:t}=this.config;let e=null;return this.config.cachedData&&this.config.cachedData.data?e=this.config.cachedData.data:(e=await this.config.queue.get(this.config.path,this.options),this.config.cachedData&&(this.config.cachedData.data=e)),t(e)}clearCache(){this.config.cachedData&&(this.config.cachedData.data=null)}}class a extends r{constructor(t){super(t),this.config=t,this.acceptsPartial=!1,this.config.batchUpdate="batchUpdate"in this.config&&this.config.batchUpdate}async create(t){throw Error("Not implemented")}updateBatch(t,e){const{serialize:i}=this.config,o=[],n=[...new Set([...Object.keys(t),...Object.keys(e)])];for(const i of n){t[i]||e[i]||o.push(this.config.queue.delete(`${this.config.path}/${i}`,this.options))}const r=i(t,e),a=Object.assign(Object.assign({},this.options),{body:r});return o.push(this.config.queue.request(this.config.httpMethod||s.POST,this.config.path,a)),Promise.all(o)}updateInternal(t,e){const{serialize:i}=this.config,n=[],r=Object.assign({},this.options),a=Object.keys(t),h=Object.keys(e),c=(0,o.XN)(a.concat(h));for(const o in c){const a=c[o],h=t[a]||e[a];if(h){const t={};t[a]=h;const o={},c=e[a];c&&(o[a]=c);const u=i(t,o);r.body=u,n.push(this.config.queue.request(this.config.httpMethod||s.POST,this.config.path,r))}else n.push(this.config.queue.delete(`${this.config.path}/${a}`,this.options))}return Promise.all(n)}async update(t,e){this.clearCache(),await(this.config.batchUpdate?this.updateBatch(t,e||{}):this.updateInternal(t,e||{}))}async delete(t){throw Error("Not implemented")}}},81248:(t,e,i)=>{i.d(e,{Bv:()=>d,Dv:()=>h,TE:()=>c,l0:()=>l,o7:()=>u});var s=i(81396);const o=-1,n=10,r=5,a=-5,h=(t,e=o)=>i=>t.distanceToSquared(i.position)*e,c=(t,e=o)=>i=>t.distanceTo(i.position)*e,u=(t,e,i=n)=>{const o=new s.Vector3;return s=>o.copy(s.position).sub(t).normalize().dot(e)*i},l=(t,e=o)=>i=>t.distanceToSquared(i.floorPosition)*e,d=(t,e=r,i=a)=>s=>t===s.floorId?e:i},87928:(t,e,i)=>{i.d(e,{E:()=>o});var s=i(81396);class o extends s.Mesh{constructor(t,e){super(t,e)}}}}]);